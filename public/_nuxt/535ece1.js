(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{604:function(e,t,r){"use strict";r.r(t);r(38),r(172),r(41),r(25),r(64),r(4),r(9),r(12),r(465);var n=r(0),o=r(118),c=r(507);n.a.use(o.a),t.default={data:function(){return{mydate:(new Date).toISOString().substr(0,10),secondsValue:0,secondsValueStart:0,message:"CoM_Method",Nishio:!0,NishioHP:!0,Fukushima:!1,TimeIncrease:[0,0],machinesRensou:{},excludeSetTime:[]}},components:{compMachineHP:c.default},mounted:function(){var e=new Date(Date.now()+60*((new Date).getTimezoneOffset()+540)*1e3);this.mydate="".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()),this.FireStoreGet(),this.excludeSet(),this.fillData()},computed:{getTest:function(){},getStatusData:function(){return this.$store.getters["timeBank/getStatus"](this.nameAB)},getProgressSeconds:function(){return this.$store.getters["timeBank/getProgressSeconds"]},getNow:function(){new Date;return this.$store.getters.getNow},getGenzaiJikan:function(){return this.$store.getters["timeBank/getKeikaJikanByou"]},getCA:function(){return this.$store.getters["timeBank/getCycleArray2"]},getCA2:function(){return this.$store.getters["timeBank/getCycleArray"]},reverseItems:function(){return this.data_Teishi_Title.slice().reverse().splice(0,7)},RDS:function(){return this.data_sample},GetD:function(){return this.$store.getters["counter/counter"]},getKadouJikanVuex:function(){return this.$store.getters.getKadouJikan},getKeikaJikan:function(){return this.$store.getters["timeBank/getKeikaJikan"]},getmachineHourCut:function(){return this.$store.getters["timeBank/getmachineHourCutArry"]},Kadouritst:function(){return"【マシン稼働率".concat(Math.round(this.$store.getters.getKadouJikan/this.$store.getters["timeBank/getKeikaJikanByou"]*1e3)/10,"％】")}},methods:{cycleTimeArrayUD:function(){this.$store.commit("timeBank/cycleTimeArrayUD",{machineCode:"LN034",timeDeff:345})},cyclesArrayUD:function(){this.$store.commit("timeBank/cyclesArrayUD","LN034")},statusArryUD:function(){this.$store.commit("timeBank/statusArryUD","LN034")},cycleCounterUD:function(){this.$store.commit("timeBank/cycleCounterUD","MC027")},fillData:function(){this.fire()},getRandomInt:function(){return Math.floor(46*Math.random())+5},fireStoreAdd:function(e,t,r,n){this.$fire.firestore.collection("SeisanNippou").add({Date:e,Machine:t,Time:r,tantou:n}).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)}))},fire:function(){var e=this,t=new Date(this.mydate),r=t.getFullYear(),n=t.getMonth(),o=t.getDate(),c=new Date(r,n,o,7,0,0),m=new Date(r,n,o,23,59,59),h=String(Date.parse(c)),d=String(Date.parse(m));this.$fire.database.ref("CurrentTarget/").on("value",(function(t){var r=t.val();for(var i in r){var n=r[i],o=n.zuban1+n.hinmei+"  "+String(n.kijunsu)+"ｹ";e.$store.commit("timeBank/CurrentTargetUD",{TgtMachine:n.machine,TgtValue:o})}})),this.$fire.database.ref("NishioMachineCT/").orderByChild("endTime").startAt(h).endAt(d).on("value",(function(t){e.initData();var data=t.val();for(var i in data){var r=data[i],n=new Date(Number(r.endTime)),o=new Date(Number(r.startTime));o<new Date(2020,12,31)&&(o=n);var c=String(n.getFullYear()),m=String(n.getMonth()+1),h=String(n.getDate()),d=String(n.getHours()),l=String(n.getMinutes()),S=String(n.getSeconds()),y="".concat(e.zeroPadding(d,2),": \n                                        ").concat(e.zeroPadding(l,2),": \n                                        ").concat(e.zeroPadding(S,2)," "),k=String(o.getFullYear()),T=String(o.getMonth()+1),D=String(o.getDate()),f=String(o.getHours()),B=String(o.getMinutes()),$=String(o.getSeconds()),C=("(Start=)".concat(k,"年").concat(T,"月").concat(D,"日").concat(f,"時").concat(B,"分").concat($,"秒"),(Number(r.endTime)-Number(r.startTime))/1e3);C>3e4&&(C=0);new Date(n-o);var A=r.machine;e.TimeIncrease[Number(r.Status)-1]+=C,e.DoSwitch(r.status,A,C,f,d,o,n,y),e.$store.commit("timeBank/sensingTimeArryUD",{machineCode:A,sensingStartTime:o,sensingEndTime:n,JustSensingTime:Date.now()}),e.$store.commit("timeBank/sensingTimeStArryUD",{machineCode:A,sensingTime:y});var U=c+m+h+"  "+d+"時"+l+"分"+S+"秒",M=r.status;e.lastS=M,e.lastD=U}e.timeBegan=new Date,e.started=setInterval(e.keikaJikan,1e3)}))},FireStoreGet:function(){var e=this;this.machines=[];this.$fire.firestore.collection("machines").get().then((function(t){t.forEach((function(t){e.machinesRensou[t.id]=[t.data()],e.machines.push(Object.assign({machine:t.id},t.data()));var r=60*Number(t.data().CTm)+Number(t.data().CTs);e.$store.commit("timeBank/CycleTimeByouArrySet",{TgtMachine:t.id,CycleTimeByou:r})}))}))},initData:function(){for(var e=this,t=0,r=Object.keys(this.$store.getters["timeBank/getStatusFull"]);t<r.length;t++){var n=r[t];this.$store.commit("timeBank/cycleTimeArrayUD",n),this.$store.commit("timeBank/cycleCounterRst",n),this.$store.commit("timeBank/cycleCounterErrRst",n),this.$store.commit("timeBank/cycleCounterDDRRst",n),this.$store.commit("timeBank/cycleTimeArrayRst",n),this.$store.commit("timeBank/cycleTimeArrayErrRst",n),this.$store.commit("timeBank/cycleTimeArrayDDRRst",n),this.$store.commit("timeBank/cycleTimeArrayKKTRst",n),this.$store.commit("timeBank/cycleTimeArrayMaijiRst",n)}this.standArry=this.$store.getters["timeBank/getStatusFull"],Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/StopWatchSinceStartRST",{machineCode:t,machineHour:0})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/machineHourCutArryUD",{machineCode:t,machineHour:0})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleCounterUD",{machineCode:t,first:!0})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleCounterErrUD",{machineCode:t,first:!0})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleCounterDDRUD",{machineCode:t,first:!0})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleTimeArrayRst",{machineCode:t})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleTimeArrayErrRst",{machineCode:t})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleTimeArrayDDRRst",{machineCode:t})})),Object.keys(this.standArry).forEach((function(t){return e.$store.commit("timeBank/cycleTimeArrayKKTRst",{machineCode:t})})),this.lastD=0,this.count=0,this.dataCount=0},DoSwitch:function(e,t,r,n,o,c,m,h){switch(e){case"RUN1":r>2&&(this.dataCount++,this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:1}),this.$store.commit("timeBank/cycleCounterUD",{machineCode:t,first:!1}),this.$store.commit("timeBank/machineHourArryUD",{current_state:1,machineCode:t,machineHour:r}),this.MaijiArrayVuexSet(n,o,c,m,t,r,4,"timeBank/cycleTimeArrayMaijiUD"),this.$store.commit("timeBank/sensingTimeArryJustOnlyUD",{machineCode:t,JustSensingTime:new Date}));break;case"RUN2":1==this.$store.getters["timeBank/getStatus"](t)&&(this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:0}),this.$store.commit("timeBank/cycleTimeArrayUD",{machineCode:t,timeDeff:r,UD:!0}),this.MaijiArrayVuexSet(n,o,c,m,t,r,0,"timeBank/cycleTimeArrayMaijiUD"),this.$store.commit("timeBank/machineHourArryUD",{current_state:0,machineCode:t,machineHour:r}),this.$store.commit("timeBank/machineHourCutArryUD",{machineCode:t,machineHour:r}),this.$store.commit("timeBank/sensingTimeArryUD",{machineCode:t,sensingStartTime:c,sensingTime:m}),this.$store.commit("timeBank/sensingTimeStArryUD",{machineCode:t,sensingTime:h}));break;case"DDR1":r>2&&(this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:3}),this.$store.commit("timeBank/cycleCounterDDRUD",{machineCode:t,first:!1}),this.MaijiArrayVuexSet(n,o,c,m,t,r,4,"timeBank/cycleTimeArrayMaijiUD"));break;case"DDR2":3==this.$store.getters["timeBank/getStatus"](t)&&(this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:0}),this.$store.commit("timeBank/cycleTimeArrayDDRUD",{machineCode:t,timeDeff:r}),"GT999"==t&&console.log("チェック中"+t+"は、"+r),this.MaijiArrayVuexSet(n,o,c,m,t,r,1,"timeBank/cycleTimeArrayMaijiUD"),this.$store.commit("timeBank/machineHourArryUD",{current_state:2,machineCode:t,machineHour:r}));break;case"KKT1":r>2&&(this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:4}),this.MaijiArrayVuexSet(n,o,c,m,t,r,4,"timeBank/cycleTimeArrayMaijiUD"));break;case"KKT2":4==this.$store.getters["timeBank/getStatus"](t)&&(this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:0}),this.$store.commit("timeBank/cycleTimeArrayKKTUD",{machineCode:t,timeDeff:r}),this.MaijiArrayVuexSet(n,o,c,m,t,r,3,"timeBank/cycleTimeArrayMaijiUD"));break;case"ERR1":this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:2}),this.$store.commit("timeBank/cycleCounterErrUD",{machineCode:t,first:!1}),this.MaijiArrayVuexSet(n,o,c,m,t,r,4,"timeBank/cycleTimeArrayMaijiUD");break;case"ERR2":2==this.$store.getters["timeBank/getStatus"](t)&&(this.$store.commit("timeBank/statusArryUD",{machineCode:t,statusBool:0}),this.$store.commit("timeBank/cycleTimeArrayErrUD",{machineCode:t,timeDeff:r}),this.MaijiArrayVuexSet(n,o,c,m,t,r,2,"timeBank/cycleTimeArrayMaijiUD"));break;default:console.log("switch,一致しない")}},MaijiArrayVuexSet:function(e,t,r,n,o,c,m,h){var d=[0,0,0,0,0,0,0,0,0,0,0],l=60*r.getMinutes()+r.getSeconds();if(e==t)d[Number(e)-7]=c,this.$store.commit("timeBank/GuntArryPush",{GuntStart:l,GuntHorizon:c,y:15*(e-4),NowState:m,machine:o});else{var S=new Date(n);S.setHours(Number(e)+1),S.setMinutes(0),S.setSeconds(0);var y=new Date(S-r),k=60*y.getMinutes()+y.getSeconds();d[e-8]=k;var T=Number(t)-Number(e);this.$store.commit("timeBank/GuntArryPush",{GuntStart:l,GuntHorizon:k,y:15*(e-4),NowState:m,machine:o});for(var i=1;i<T;i++)d[i+(Number(e)-8)]=3600,this.$store.commit("timeBank/GuntArryPush",{GuntStart:0,GuntHorizon:3600,y:15*(i+Number(e-4)),NowState:m,machine:o});S.setHours(Number(t));var D=new Date(n-S),f=60*D.getUTCMinutes(),B=D.getUTCSeconds(),$=f+B;d[Number(e)-8+T]=f+B,this.$store.commit("timeBank/GuntArryPush",{GuntStart:0,GuntHorizon:$,y:15*(t-4),NowState:m,machine:o})}this.$store.commit(h,{machineCode:o,start:e,end:t,elapsed:d,timeDeff:c,nowTgt:m})},excludeSet:function(){for(var i=0;i<14;i++)this.excludeSetTime[i]=new Date;this.excludeSetTime[0].setHours(8,0,0),this.excludeSetTime[1].setHours(9,0,0),this.excludeSetTime[2].setHours(10,0,0),this.excludeSetTime[3].setHours(10,10,0),this.excludeSetTime[4].setHours(11,0,0),this.excludeSetTime[5].setHours(12,0,0),this.excludeSetTime[6].setHours(12,50,0),this.excludeSetTime[7].setHours(14,0,0),this.excludeSetTime[8].setHours(15,0,0),this.excludeSetTime[9].setHours(15,10,0),this.excludeSetTime[10].setHours(16,0,0),this.excludeSetTime[11].setHours(17,0,0),this.excludeSetTime[12].setHours(18,0,0),this.excludeSetTime[13].setHours(19,0,0)},keikaJikan:function(){var e=new Date,t=new Date;switch(t.setHours(8,0,0),!0){case e<this.excludeSetTime[2]:this.excludedTime=[0,0,0];break;case e<this.excludeSetTime[3]:this.excludedTime=[new Date(e-this.excludeSetTime[2]).getMinutes(),0,0];break;case e<this.excludeSetTime[5]:this.excludedTime=[10,0,0];break;case e<this.excludeSetTime[6]:this.excludedTime=[10,new Date(e-this.excludeSetTime[3]).getMinutes(),0];break;case e<this.excludeSetTime[8]:this.excludedTime=[10,50,0];break;case e<this.excludeSetTime[9]:this.excludedTime=[10,50,new Date(e-this.excludeSetTime[5]).getMinutes()];break;case e<this.excludeSetTime[13]:case e>this.excludeSetTime[13]:this.excludedTime=[10,50,10]}var r=this.excludedTime[0]+this.excludedTime[1]+this.excludedTime[2],n=new Date(e-t);n.setMinutes(n.getMinutes()-r),this.$store.commit("timeBank/TB_Kadoujikan",n);var o=n.getUTCHours(),c=n.getUTCMinutes(),m=n.getUTCSeconds(),h=3600*o+60*c+m;this.$store.commit("timeBank/ProgressSecondsUD",h);this.KadouJikan="".concat(o,":").concat(String(c).padStart(2,"0"),":").concat(String(m).padStart(2,"0"));this.GenzaiJikan="".concat(String(e.getMonth()+1),"月\n      ").concat(String(e.getDate()),"日（\n      ").concat(String(["日","月","火","水","木","金","土"][e.getDay()]),"）\n      ").concat(String(e.getHours()).padStart(2,"0"),":\n       ").concat(String(e.getMinutes()).padStart(2,"0"),":\n       ").concat(String(e.getSeconds()).padStart(2,"0")),this.$store.commit("timeBank/genzaiJikanUD",this.GenzaiJikan);for(var d=0,l=Object.keys(this.$store.getters["timeBank/getStopWatchArrayPrimitive"]);d<l.length;d++){var S=l[d],y=this.$store.getters["timeBank/getSensingTime"](S),k=this.$store.getters["timeBank/getSensingTimeStart"](S),T=this.$store.getters["timeBank/get_sensingTimeArryJust"](S),D=new Date(Date.now()-y),f=new Date(Date.now()-k),B=new Date(Date.now()-T),h1=D.getUTCHours(),$=D.getUTCMinutes(),C=60*D.getUTCHours()+$,A=D.getUTCSeconds(),U=f.getUTCHours(),M=(f.getUTCMinutes(),60*f.getUTCHours()+$),w=f.getUTCSeconds(),x=B.getUTCHours(),H=B.getUTCMinutes(),v=60*B.getUTCHours()+H,j=B.getUTCSeconds(),h2=String(h1).padStart(2,"0"),R=String($).padStart(2,"0"),N=String(C),J=String(A).padStart(2,"0"),E=("".concat(h2,":").concat(R,":").concat(J),"".concat(N,"分").concat(J,"秒"));if(this.secondsValue=3600*h1+60*$+A,this.secondsValueStart=3600*U+M+w,this.secondsValueJust=3600*x+60*v+j,this.$store.commit("timeBank/StopWatchArryUD",{machineCode:S,StopWatchTime:E,StopWatchSecondsTime:this.secondsValue,StopWatchSecondsTimeStart:this.secondsValueStart,StopWatchSecondsTimeJust:this.secondsValueJust}),1==this.$store.getters["timeBank/getStatus"](S)){var K=this.$store.getters["timeBank/getmachineHourArryTgt"](S)[0],G=this.$store.getters["timeBank/getSensingTime"](S);if(K>0){var V=(new Date).getTime()-G.getTime(),z=V/6e4,O=(V%=6e4)/1e3,P=K-(60*Math.floor(z)+Math.floor(O));this.$store.commit("timeBank/machineHourCutArryUD",{machineCode:S,machineHour:P})}}}},JikanHenkan:function(e){var t=Math.floor(e/60),s="00"+String(e%60);return"".concat(t,"'").concat(s.slice(-2))},zeroPrefix:function(){for(var e="",i=0;i<digit;i++)e+="0";return(e+num).slice(-digit)},zeroPadding:function(e,t){return("00000000"+String(e)).slice(-t)}}}}}]);